<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste R√°pido - SDK + Extens√£o</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .status {
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            font-weight: bold;
        }
        
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        
        .ad-container {
            width: 100%;
            height: 200px;
            border: 2px dashed #ddd;
            margin: 20px 0;
        }
        
        .info-box {
            background: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #007bff;
            margin: 15px 0;
        }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover { background: #0056b3; }
        
        .wallet-info {
            font-family: monospace;
            word-break: break-all;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Teste R√°pido - SDK + Extens√£o</h1>
        <p>Esta p√°gina testa a integra√ß√£o b√°sica entre o SDK e a extens√£o.</p>
        
        <!-- Status da Extens√£o -->
        <div id="extension-status" class="status warning">
            ‚è≥ Verificando extens√£o...
        </div>
        
        <!-- Informa√ß√µes da Carteira -->
        <div id="wallet-section" style="display: none;">
            <h3>üí≥ Informa√ß√µes da Carteira</h3>
            <div class="info-box">
                <strong>Chave P√∫blica:</strong><br>
                <div id="wallet-key" class="wallet-info">-</div>
            </div>
            <div class="info-box">
                <strong>Saldo Atual:</strong> <span id="wallet-balance">0.0000</span> XLM
            </div>
        </div>
        
        <!-- √Årea do An√∫ncio -->
        <h3>üì∫ An√∫ncio</h3>
        <div id="stellar-ad-container" 
             data-site-id="teste-rapido" 
             data-tags="test,demo"
             class="ad-container">
        </div>
        
        <!-- Controles -->
        <h3>üéÆ Controles</h3>
        <button onclick="installExtension()">üì¶ Simular Extens√£o</button>
        <button onclick="reloadAd()">üîÑ Recarregar An√∫ncio</button>
        <button onclick="checkStatus()">üîç Verificar Status</button>
        
        <!-- Console de Status -->
        <h3>üìã Status do Sistema</h3>
        <div id="console" class="info-box" style="font-family: monospace; font-size: 12px;">
            Sistema iniciando...<br>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="extension-example.js"></script>
    <script src="sdk.js"></script>
    
    <script>
        let consoleElement = document.getElementById('console');
        
        function log(message) {
            const time = new Date().toLocaleTimeString();
            consoleElement.innerHTML += `[${time}] ${message}<br>`;
            consoleElement.scrollTop = consoleElement.scrollHeight;
        }
        
        function installExtension() {
            log('üì¶ Simulando instala√ß√£o da extens√£o...');
            
            setTimeout(() => {
                if (window.stellarAdsExtension) {
                    updateUI();
                    log('‚úÖ Extens√£o simulada instalada com sucesso!');
                } else {
                    log('‚ùå Erro ao simular extens√£o');
                }
            }, 1000);
        }
        
        function updateUI() {
            const statusDiv = document.getElementById('extension-status');
            const walletSection = document.getElementById('wallet-section');
            
            if (window.stellarAdsExtension && window.stellarAdsExtension.userWallet) {
                statusDiv.className = 'status success';
                statusDiv.textContent = '‚úÖ Extens√£o conectada - Carteira dispon√≠vel';
                
                walletSection.style.display = 'block';
                
                const publicKey = window.stellarAdsExtension.userWallet.publicKey;
                document.getElementById('wallet-key').textContent = publicKey;
                
                refreshBalance();
            } else {
                statusDiv.className = 'status error';
                statusDiv.textContent = '‚ùå Extens√£o n√£o encontrada ou sem carteira';
                walletSection.style.display = 'none';
            }
        }
        
        async function refreshBalance() {
            if (!window.stellarAdsExtension) return;
            
            try {
                log('üí∞ Consultando saldo da carteira...');
                const balance = await window.stellarAdsExtension.getCurrentBalance();
                document.getElementById('wallet-balance').textContent = balance.toFixed(4);
                log(`üí∞ Saldo: ${balance.toFixed(4)} XLM`);
            } catch (error) {
                log(`‚ùå Erro ao consultar saldo: ${error.message}`);
            }
        }
        
        function reloadAd() {
            log('üîÑ Recarregando an√∫ncio...');
            if (window.StellarAdsSDK && window.StellarAdsSDK.reinitialize) {
                window.StellarAdsSDK.reinitialize();
                log('üì∫ An√∫ncio recarregado');
            } else {
                log('‚ùå SDK n√£o dispon√≠vel');
            }
        }
        
        function checkStatus() {
            log('üîç Verificando status do sistema...');
            
            log(`- SDK carregado: ${window.StellarAdsSDK ? '‚úÖ' : '‚ùå'}`);
            log(`- Extens√£o: ${window.stellarAdsExtension ? '‚úÖ' : '‚ùå'}`);
            
            if (window.stellarAdsExtension) {
                log(`- Carteira: ${window.stellarAdsExtension.userWallet ? '‚úÖ' : '‚ùå'}`);
            }
            
            const adContainer = document.getElementById('stellar-ad-container');
            log(`- Container de an√∫ncio: ${adContainer.innerHTML.trim() ? '‚úÖ Com conte√∫do' : '‚è≥ Vazio'}`);
        }
        
        // Verificar status periodicamente
        setInterval(() => {
            updateUI();
        }, 3000);
        
        // Log inicial
        log('üöÄ P√°gina de teste carregada');
        log('‚ÑπÔ∏è Clique em "Simular Extens√£o" para come√ßar');
        
        // Interceptar mensagens do SDK
        const originalConsoleLog = console.log;
        console.log = function(...args) {
            if (args[0] && args[0].includes && args[0].includes('[Stellar Ads SDK]')) {
                log(`SDK: ${args.slice(1).join(' ')}`);
            }
            originalConsoleLog.apply(console, args);
        };
    </script>
</body>
</html>
