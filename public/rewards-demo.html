<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Demo - Sistema de Recompensas Stellar Ads</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
      }

      .header {
        background: rgba(255, 255, 255, 0.95);
        padding: 20px;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .header h1 {
        color: #667eea;
        margin-bottom: 10px;
      }

      .header p {
        color: #666;
        font-size: 16px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .demo-section {
        background: white;
        margin: 20px 0;
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }

      .demo-section h2 {
        color: #667eea;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .ad-container {
        width: 300px;
        height: 250px;
        margin: 20px auto;
        border: 2px dashed #ddd;
        border-radius: 8px;
        position: relative;
      }

      .rewards-info {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 15px;
        border-radius: 8px;
        margin: 15px 0;
      }

      .rewards-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }

      .stat-card {
        background: #f8f9ff;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        border: 2px solid #e8ebff;
      }

      .stat-value {
        font-size: 24px;
        font-weight: bold;
        color: #667eea;
        margin-bottom: 5px;
      }

      .stat-label {
        color: #666;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .instructions {
        background: #e8f5e8;
        border-left: 4px solid #4caf50;
        padding: 15px;
        margin: 15px 0;
      }

      .instructions h3 {
        color: #2e7d32;
        margin-bottom: 10px;
      }

      .instructions ol {
        padding-left: 20px;
      }

      .instructions li {
        margin: 8px 0;
        color: #2e7d32;
      }

      .warning {
        background: #fff3cd;
        border-left: 4px solid #ffc107;
        padding: 15px;
        margin: 15px 0;
      }

      .warning h3 {
        color: #856404;
        margin-bottom: 10px;
      }

      .warning p {
        color: #856404;
      }

      .refresh-btn {
        background: #667eea;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        margin: 10px 5px;
        transition: background 0.3s ease;
      }

      .refresh-btn:hover {
        background: #5a67d8;
      }

      .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }

      @media (max-width: 768px) {
        .container {
          padding: 10px;
        }

        .demo-section {
          padding: 15px;
        }

        .ad-container {
          width: 100%;
          max-width: 300px;
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>üåü Sistema de Recompensas Stellar Ads</h1>
      <p>
        Ganhe XLM visualizando e clicando em an√∫ncios! Teste o sistema
        anti-farming com limite de 6 horas.
      </p>
    </div>

    <div class="container">
      <div class="demo-section">
        <h2>üí∞ Como Funciona o Sistema de Recompensas</h2>

        <div class="info-grid">
          <div>
            <h3>Para Usu√°rios Visitantes:</h3>
            <ul>
              <li><strong>0.001 XLM</strong> por visualiza√ß√£o de an√∫ncio</li>
              <li><strong>10% do valor</strong> por clique no an√∫ncio</li>
              <li>Limite: <strong>1 recompensa a cada 6 horas</strong></li>
              <li>Sistema anti-farming autom√°tico</li>
            </ul>
          </div>

          <div>
            <h3>Para Donos de Sites:</h3>
            <ul>
              <li><strong>70% do valor</strong> de cada clique</li>
              <li>Receita adicional por impress√µes</li>
              <li>Pagamentos autom√°ticos via Stellar</li>
              <li>Dashboard de analytics</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="demo-section">
        <h2>üéØ An√∫ncio de Demonstra√ß√£o</h2>

        <div class="instructions">
          <h3>üìã Instru√ß√µes para Teste:</h3>
          <ol>
            <li>Visualize o an√∫ncio abaixo (ganhe 0.001 XLM)</li>
            <li>Clique no an√∫ncio (ganhe 10% do valor)</li>
            <li>Atualize a p√°gina e tente novamente</li>
            <li>Observe o sistema de limite temporal</li>
          </ol>
        </div>

        <!-- Container do an√∫ncio -->
        <div
          id="stellar-ad-container"
          data-site-id="site_example_123"
          data-tags="tecnologia,programacao,demo"
          class="ad-container"
        >
          <!-- O SDK carregar√° o an√∫ncio aqui -->
        </div>

        <div class="warning">
          <h3>‚ö†Ô∏è Sistema Anti-Farming Ativo</h3>
          <p>
            Cada usu√°rio pode ganhar recompensas apenas
            <strong>1 vez a cada 6 horas</strong> para evitar farming. O sistema
            identifica usu√°rios √∫nicos baseado no IP e navegador.
          </p>
        </div>
      </div>

      <div class="demo-section">
        <h2>üìä Suas Estat√≠sticas de Recompensas</h2>
        <div id="user-stats-container">
          <!-- Estat√≠sticas ser√£o carregadas aqui -->
        </div>
      </div>

      <div class="demo-section">
        <h2>üîÑ Controles de Teste</h2>
        <button class="refresh-btn" onclick="reloadAd()">
          üîÑ Recarregar An√∫ncio
        </button>
        <button class="refresh-btn" onclick="checkRewards()">
          üíé Verificar Recompensas
        </button>
        <button class="refresh-btn" onclick="window.location.reload()">
          üåê Reiniciar P√°gina
        </button>
      </div>

      <div class="demo-section">
        <h2>üí∞ Como Verificar XLM na Carteira</h2>

        <div class="instructions">
          <h3>üìã Tutorial: Verificando seus XLM na Testnet</h3>
          <ol>
            <li>
              <strong>Acesse o Stellar Laboratory:</strong> <br /><a
                href="https://laboratory.stellar.org"
                target="_blank"
                style="color: #2e7d32"
                >https://laboratory.stellar.org</a
              >
            </li>
            <li><strong>V√° para "Account Viewer"</strong> no menu superior</li>
            <li>
              <strong>Cole uma dessas chaves p√∫blicas</strong> (sites de
              exemplo):
              <div
                style="
                  background: #f5f5f5;
                  padding: 10px;
                  margin: 10px 0;
                  border-radius: 4px;
                  font-family: monospace;
                  font-size: 12px;
                "
              >
                <strong>Blog do Desenvolvedor:</strong><br />
                <span id="site1-key" style="word-break: break-all"
                  >GBIHICOSDVKSHZMXISXIVMBY5KOKK374BYOCR3WIZK7LY6PLHXXDV2YK</span
                >
                <button
                  onclick="copyToClipboard('site1-key')"
                  style="
                    margin-left: 10px;
                    padding: 2px 8px;
                    background: #667eea;
                    color: white;
                    border: none;
                    border-radius: 3px;
                    cursor: pointer;
                  "
                >
                  üìã
                </button>
              </div>
            </li>
            <li>
              <strong>Ou verifique a conta da plataforma:</strong>
              <div
                style="
                  background: #f5f5f5;
                  padding: 10px;
                  margin: 10px 0;
                  border-radius: 4px;
                  font-family: monospace;
                  font-size: 12px;
                "
              >
                <strong>Conta da Plataforma:</strong><br />
                <span id="platform-key" style="word-break: break-all"
                  >GCEK6LAV4CYV2OBVRHMCBY3E4M3ZQKVJI2THH3ZDZGPHN4O3V6TPT5EF</span
                >
                <button
                  onclick="copyToClipboard('platform-key')"
                  style="
                    margin-left: 10px;
                    padding: 2px 8px;
                    background: #667eea;
                    color: white;
                    border: none;
                    border-radius: 3px;
                    cursor: pointer;
                  "
                >
                  üìã
                </button>
              </div>
            </li>
            <li><strong>Clique em "Get Account"</strong> para ver o saldo</li>
            <li>
              <strong>Veja as transa√ß√µes</strong> na aba "Operations" para
              verificar pagamentos
            </li>
          </ol>
        </div>

        <div class="warning">
          <h3>‚ö†Ô∏è Importante</h3>
          <p>
            <strong>Testnet apenas!</strong> Esses XLM s√£o de teste. Para usar
            com XLM real, configure para a mainnet.
          </p>
        </div>

        <div class="rewards-info">
          <h3 style="margin-bottom: 10px">üîç Links R√°pidos de Verifica√ß√£o:</h3>
          <p style="margin-bottom: 8px">
            <strong>üè¢ Conta da Plataforma:</strong><br />
            <a
              href="https://laboratory.stellar.org/#explorer?resource=accounts&endpoint=single&network=test&values=GCEK6LAV4CYV2OBVRHMCBY3E4M3ZQKVJI2THH3ZDZGPHN4O3V6TPT5EF"
              target="_blank"
              style="color: #fff; text-decoration: underline"
            >
              Ver Conta da Plataforma ‚Üí
            </a>
          </p>
          <p style="margin-bottom: 8px">
            <strong>üì∞ Site Exemplo (Blog do Desenvolvedor):</strong><br />
            <a
              href="https://laboratory.stellar.org/#explorer?resource=accounts&endpoint=single&network=test&values=GBIHICOSDVKSHZMXISXIVMBY5KOKK374BYOCR3WIZK7LY6PLHXXDV2YK"
              target="_blank"
              style="color: #fff; text-decoration: underline"
            >
              Ver Conta do Site ‚Üí
            </a>
          </p>
        </div>
      </div>
    </div>

    <!-- Carregar o SDK -->
    <script src="/sdk.js"></script>

    <script>
      // Habilitar debug
      window.StellarAdsSDK.debug = true;

      // Fun√ß√£o para recarregar an√∫ncio
      function reloadAd() {
        console.log("Recarregando an√∫ncio...");
        if (window.StellarAdsSDK && window.StellarAdsSDK.reinitialize) {
          window.StellarAdsSDK.reinitialize();
        } else {
          window.location.reload();
        }
      }

      // Fun√ß√£o para verificar recompensas
      async function checkRewards() {
        try {
          const response = await fetch(
            "/api/user-rewards?siteId=site_example_123"
          );
          const data = await response.json();

          if (data.success) {
            displayUserStats(data.userRewards);
          } else {
            console.error("Erro ao verificar recompensas:", data.error);
          }
        } catch (error) {
          console.error("Erro na requisi√ß√£o:", error);
        }
      }

      // Fun√ß√£o para exibir estat√≠sticas
      function displayUserStats(rewardsData) {
        const container = document.getElementById("user-stats-container");

        const canReceive = rewardsData.canReceiveRewards;
        const nextReward = rewardsData.nextRewardInMinutes;
        const stats = rewardsData.statistics;

        let statusHtml = "";
        if (canReceive) {
          statusHtml = `
                    <div class="rewards-info">
                        ‚úÖ <strong>Voc√™ pode receber recompensas agora!</strong><br>
                        Visualize ou clique nos an√∫ncios para ganhar XLM.
                    </div>
                `;
        } else {
          const hoursLeft = Math.ceil(nextReward / 60);
          statusHtml = `
                    <div class="rewards-info" style="background: linear-gradient(135deg, #ff7b7b 0%, #667eea 100%);">
                        ‚è∞ <strong>Pr√≥xima recompensa em ~${hoursLeft} hora(s)</strong><br>
                        Sistema anti-farming ativo. Aguarde para ganhar novamente.
                    </div>
                `;
        }

        container.innerHTML = `
                ${statusHtml}
                <div class="rewards-stats">
                    <div class="stat-card">
                        <div class="stat-value">${stats.totalImpressions}</div>
                        <div class="stat-label">Visualiza√ß√µes</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.totalClicks}</div>
                        <div class="stat-label">Cliques</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.totalEarnedXLM.toFixed(
                          4
                        )}</div>
                        <div class="stat-label">XLM Ganhos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${
                          stats.lastRewardAt
                            ? new Date(stats.lastRewardAt).toLocaleDateString()
                            : "Nunca"
                        }</div>
                        <div class="stat-label">√öltima Recompensa</div>
                    </div>
                </div>
            `;
      }

      // Fun√ß√£o para copiar texto para a √°rea de transfer√™ncia
      function copyToClipboard(elementId) {
        const element = document.getElementById(elementId);
        const text = element.textContent;

        if (navigator.clipboard) {
          navigator.clipboard.writeText(text).then(() => {
            // Feedback visual
            const originalText = element.textContent;
            element.textContent = "Copiado!";
            element.style.color = "#4caf50";
            setTimeout(() => {
              element.textContent = originalText;
              element.style.color = "";
            }, 2000);
          });
        } else {
          // Fallback para navegadores mais antigos
          const textarea = document.createElement("textarea");
          textarea.value = text;
          document.body.appendChild(textarea);
          textarea.select();
          document.execCommand("copy");
          document.body.removeChild(textarea);
        }
      }

      // Verificar recompensas ao carregar a p√°gina
      setTimeout(() => {
        checkRewards();
      }, 2000);

      // Atualizar estat√≠sticas a cada 30 segundos
      setInterval(checkRewards, 30000);
    </script>
  </body>
</html>
